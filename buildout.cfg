[buildout]
develop =
    .
    pwt.recipe.closurebuilder

parts =
# libraries and 3rd party
    closure-library
# files
    deps.js
    compiled.js
# commands
    compiler
    shell
    serve
    test

unzip = true

[closure-library]
recipe = infrae.subversion
urls = http://closure-library.googlecode.com/svn/trunk@714 closure-library
ignore_verification = true

[deps.js]
recipe = jscomp:dependency
output = src/jscomp/media/deps.js
root_with_prefix =
    ${closure-library:location}/closure-library /closure
    src/jscomp/media /media
    src/jscomp/templates /soy
extension = soy

[compiled.js]
recipe = pwt.recipe.closurebuilder:compile
dependency = deps.js
jar = /home/michael/src/oss/closure/closure-compiler-read-only/build/compiler.jar
inputs = src/jscomp/media/tests.js
output = src/jscomp/media

[compiler]
recipe = zc.recipe.egg
scripts = jscompiler
eggs =
    jscomp

[shell]
recipe = zc.recipe.egg
scripts = ipython=shell
eggs =
    jscomp
    ipython

[settings.ini]
recipe = collective.recipe.template
input = ${buildout:directory}/etc/settings.ini.in
output = ${buildout:directory}/etc/settings.ini

[serve]
recipe = zc.recipe.egg
scripts = paster=serve
arguments =
    args = ["serve", "${settings.ini:output}"] + sys.argv[1:]
eggs =
    jscomp
    PasteScript

[test]
recipe = zc.recipe.egg
scripts = nosetests=test
arguments =
    argv = sys.argv[0:1]
    +
    ["--nocapture",
     "--nologcapture",
     "--exe",
     "--with-test-suites",
     "--test-suites-include=jinja2.testsuite.suite",
     "--test-suites-include=pwt.recipe.closurebuilder.tests.suite",
    ] + sys.argv[1:]
eggs =
    nose
    jscomp [test]
